{"$schema":"https://json.schemastore.org/sarif-2.1.0.json","version":"2.1.0","runs":[{"tool":{"driver":{"name":"CodeQL","organization":"GitHub","semanticVersion":"2.23.6","notifications":[{"id":"cpp/baseline/expected-extracted-files","name":"cpp/baseline/expected-extracted-files","shortDescription":{"text":"Expected extracted files"},"fullDescription":{"text":"Files appearing in the source archive that are expected to be extracted."},"defaultConfiguration":{"enabled":true},"properties":{"tags":["expected-extracted-files","telemetry"]}},{"id":"cli/platform","name":"cli/platform","shortDescription":{"text":"Platform"},"fullDescription":{"text":"Platform"},"defaultConfiguration":{"enabled":true}},{"id":"cpp/extractor/platform","name":"cpp/extractor/platform","shortDescription":{"text":"C++ extractor platform telemetry"},"fullDescription":{"text":"C++ extractor platform telemetry"},"defaultConfiguration":{"enabled":true}},{"id":"cpp/extractor/summary","name":"cpp/extractor/summary","shortDescription":{"text":"C++ extractor telemetry"},"fullDescription":{"text":"C++ extractor telemetry"},"defaultConfiguration":{"enabled":true}}],"rules":[{"id":"custom/format-string","name":"custom/format-string","defaultConfiguration":{"enabled":true,"level":"warning"},"properties":{"id":"custom/format-string","kind":"problem","problem.severity":"warning","summary":"Detect printf-family calls where the format argument is not a string literal."}},{"id":"custom/alloc-mult-overflow","name":"custom/alloc-mult-overflow","defaultConfiguration":{"enabled":true,"level":"warning"},"properties":{"id":"custom/alloc-mult-overflow","kind":"problem","problem.severity":"warning","summary":"Flag allocations where the size argument textually includes a multiplication (overflow risk heuristic)."}},{"id":"custom/unsafe-copy","name":"custom/unsafe-copy","defaultConfiguration":{"enabled":true,"level":"warning"},"properties":{"id":"custom/unsafe-copy","kind":"problem","problem.severity":"warning","summary":"Flags memcpy/strcpy/strcat/sprintf calls (no size checks verified)."}},{"id":"custom/use-after-free-hint","name":"custom/use-after-free-hint","defaultConfiguration":{"enabled":true,"level":"warning"},"properties":{"id":"custom/use-after-free-hint","kind":"problem","problem.severity":"warning","summary":"Heuristic: find uses of a variable after a free() in the same function."}}]},"extensions":[{"name":"custom-codeql-queries","semanticVersion":"0.0.1","locations":[{"uri":"file:///workspace/code-ql/queries/","description":{"text":"The QL pack root directory."},"properties":{"tags":["CodeQL/LocalPackRoot"]}},{"uri":"file:///workspace/code-ql/queries/qlpack.yml","description":{"text":"The QL pack definition file."},"properties":{"tags":["CodeQL/LocalPackDefinitionFile"]}}]},{"name":"codeql/cpp-all","semanticVersion":"6.1.0+117168d25bc05f8a5a313748687c56335ddf03e4","locations":[{"uri":"file:///root/.codeql/packages/codeql/cpp-all/6.1.0/","description":{"text":"The QL pack root directory."},"properties":{"tags":["CodeQL/LocalPackRoot"]}},{"uri":"file:///root/.codeql/packages/codeql/cpp-all/6.1.0/qlpack.yml","description":{"text":"The QL pack definition file."},"properties":{"tags":["CodeQL/LocalPackDefinitionFile"]}}]}]},"invocations":[{"toolExecutionNotifications":[{"locations":[{"physicalLocation":{"artifactLocation":{"uri":"include/vuln_lib.h","uriBaseId":"%SRCROOT%","index":1}}}],"message":{"text":""},"level":"none","descriptor":{"id":"cpp/baseline/expected-extracted-files","index":0},"properties":{"formattedMessage":{"text":""}}},{"locations":[{"physicalLocation":{"artifactLocation":{"uri":"src/vuln_lib.c","uriBaseId":"%SRCROOT%","index":0}}}],"message":{"text":""},"level":"none","descriptor":{"id":"cpp/baseline/expected-extracted-files","index":0},"properties":{"formattedMessage":{"text":""}}},{"locations":[{"physicalLocation":{"artifactLocation":{"uri":"fuzz/fuzz_target.cc","uriBaseId":"%SRCROOT%","index":2}}}],"message":{"text":""},"level":"none","descriptor":{"id":"cpp/baseline/expected-extracted-files","index":0},"properties":{"formattedMessage":{"text":""}}},{"message":{"text":"On the Linux (amd64; 6.14.0-36-generic) platform.","markdown":"On the Linux (amd64; 6.14.0-36-generic) platform."},"level":"none","timeUtc":"2025-11-28T02:50:53.476572517Z","descriptor":{"id":"cli/platform","index":1},"properties":{"attributes":{"arch":"amd64","name":"Linux","version":"6.14.0-36-generic"},"visibility":{"statusPage":false,"telemetry":true}}},{"message":{"text":"Internal telemetry for the C++ extractor.\n\nNo action needed.","markdown":"Internal telemetry for the C++ extractor.\n\nNo action needed."},"level":"note","timeUtc":"2025-11-28T02:50:54.549823Z","descriptor":{"id":"cpp/extractor/platform","index":2},"properties":{"attributes":{"armcc_version":0,"build_mode":"unknown","clang_version":140000,"compiler":"clang","compiler family":"Clang","gnu_version":40801,"microsoft_version":1926,"os":"linux","sizeof(int)":4,"sizeof(long long)":8,"sizeof(long)":8,"sizeof(nullptr)":8,"std_version":201710},"visibility":{"statusPage":false,"telemetry":true}}},{"message":{"text":"Internal telemetry for the C++ extractor.\n\nNo action needed.","markdown":"Internal telemetry for the C++ extractor.\n\nNo action needed."},"level":"note","timeUtc":"2025-11-28T02:50:55.440482Z","descriptor":{"id":"cpp/extractor/platform","index":2},"properties":{"attributes":{"armcc_version":0,"build_mode":"unknown","clang_version":140000,"compiler":"clang","compiler family":"Clang","gnu_version":40801,"microsoft_version":1926,"os":"linux","sizeof(int)":4,"sizeof(long long)":8,"sizeof(long)":8,"sizeof(nullptr)":8,"std_version":201703},"visibility":{"statusPage":false,"telemetry":true}}},{"message":{"text":"Internal telemetry for the C++ extractor.\n\nNo action needed.","markdown":"Internal telemetry for the C++ extractor.\n\nNo action needed."},"level":"note","timeUtc":"2025-11-28T02:50:55.719705Z","descriptor":{"id":"cpp/extractor/summary","index":3},"properties":{"attributes":{"cache-hits":0,"cache-misses":2,"compilers":[{"program":"clang","version":"Ubuntu clang version 14.0.0-1ubuntu1.1"},{"program":"clang-cc1","version":"Ubuntu clang version 14.0.0-1ubuntu1.1"}],"extractor-failures":0,"extractor-successes":2,"trap-caching":"disabled"},"visibility":{"statusPage":false,"telemetry":true}}}],"executionSuccessful":true}],"artifacts":[{"location":{"uri":"src/vuln_lib.c","uriBaseId":"%SRCROOT%","index":0}},{"location":{"uri":"include/vuln_lib.h","uriBaseId":"%SRCROOT%","index":1}},{"location":{"uri":"fuzz/fuzz_target.cc","uriBaseId":"%SRCROOT%","index":2}}],"results":[{"ruleId":"custom/format-string","ruleIndex":0,"rule":{"id":"custom/format-string","index":0},"message":{"text":"Non-literal format string may expose format-string vulnerability"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"src/vuln_lib.c","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":65,"startColumn":3,"endColumn":9}}}],"partialFingerprints":{"primaryLocationLineHash":"ea93f1386ad25e83:1","primaryLocationStartColumnFingerprint":"0"}},{"ruleId":"custom/unsafe-copy","ruleIndex":2,"rule":{"id":"custom/unsafe-copy","index":2},"message":{"text":"Potential unsafe copy via memcpy"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"src/vuln_lib.c","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":87,"startColumn":5,"endColumn":11}}}],"partialFingerprints":{"primaryLocationLineHash":"b3fa17bdaf8e47d8:1","primaryLocationStartColumnFingerprint":"0"}},{"ruleId":"custom/unsafe-copy","ruleIndex":2,"rule":{"id":"custom/unsafe-copy","index":2},"message":{"text":"Potential unsafe copy via memcpy"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"src/vuln_lib.c","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":62,"startColumn":3,"endColumn":9}}}],"partialFingerprints":{"primaryLocationLineHash":"271cd28ea0dc7355:1","primaryLocationStartColumnFingerprint":"0"}},{"ruleId":"custom/unsafe-copy","ruleIndex":2,"rule":{"id":"custom/unsafe-copy","index":2},"message":{"text":"Potential unsafe copy via memcpy"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"src/vuln_lib.c","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":47,"startColumn":3,"endColumn":9}}}],"partialFingerprints":{"primaryLocationLineHash":"3e2b01f48871d618:1","primaryLocationStartColumnFingerprint":"0"}},{"ruleId":"custom/unsafe-copy","ruleIndex":2,"rule":{"id":"custom/unsafe-copy","index":2},"message":{"text":"Potential unsafe copy via memcpy"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"src/vuln_lib.c","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":33,"startColumn":3,"endColumn":9}}}],"partialFingerprints":{"primaryLocationLineHash":"9b882e9e6304b88e:1","primaryLocationStartColumnFingerprint":"0"}},{"ruleId":"custom/unsafe-copy","ruleIndex":2,"rule":{"id":"custom/unsafe-copy","index":2},"message":{"text":"Potential unsafe copy via memcpy"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"src/vuln_lib.c","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":13,"startColumn":3,"endColumn":9}}}],"partialFingerprints":{"primaryLocationLineHash":"67a15e24f130fcb1:1","primaryLocationStartColumnFingerprint":"0"}},{"ruleId":"custom/use-after-free-hint","ruleIndex":3,"rule":{"id":"custom/use-after-free-hint","index":3},"message":{"text":"Heuristic use-after-free of 'leaky'"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"src/vuln_lib.c","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":51,"startColumn":5,"endColumn":10}}}],"partialFingerprints":{"primaryLocationLineHash":"951991333e43088d:1","primaryLocationStartColumnFingerprint":"0"}},{"ruleId":"custom/use-after-free-hint","ruleIndex":3,"rule":{"id":"custom/use-after-free-hint","index":3},"message":{"text":"Heuristic use-after-free of 'leaky'"},"locations":[{"physicalLocation":{"artifactLocation":{"uri":"src/vuln_lib.c","uriBaseId":"%SRCROOT%","index":0},"region":{"startLine":54,"startColumn":10,"endColumn":15}}}],"partialFingerprints":{"primaryLocationLineHash":"39f8cfd25a8b3009:1","primaryLocationStartColumnFingerprint":"5"}}],"columnKind":"utf16CodeUnits","properties":{"semmle.formatSpecifier":"sarifv2.1.0"}}]}